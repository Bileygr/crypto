<?php
require_once("imports.php");

$settings = parse_ini_file("conf/settings.ini", true);
$mysql_db = new PDO("mysql:host=".$settings["mysql"]["host"].";port=".$settings["mysql"]["port"].";dbname=".$settings["mysql"]["db"].";", $settings["mysql"]["user"], $settings["mysql"]["password"]);
$pgsql_db = new PDO("pgsql:host=".$settings["pgsql"]["host"].";port=".$settings["pgsql"]["port"].";dbname=".$settings["pgsql"]["db"].";", $settings["pgsql"]["user"], $settings["pgsql"]["password"]);

$pgsql_db->exec(file_get_contents("conf/pgsql/bdd.sql"));
$mysql_db->exec(file_get_contents("conf/mysql/bdd.sql"));

function genererTelephone() {
    $characters = '0123456789';
    $charactersLength = strlen($characters);
    $telephone = '';
    $suffix = "";
    $rng = rand(0,1);

    for ($i = 0; $i < 8; $i++) {
        $telephone .= $characters[rand(0, $charactersLength - 1)];
    }

    if($rng == 0){
        $suffix = "01"; 
    }elseif ($rng == 1) {
        $suffix = "06";
    }

    return $suffix.$telephone;
}

function genererPassword() {
    $alphabet = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890';
    $pass = array();
    $alphaLength = strlen($alphabet) - 1;
    for ($i = 0; $i < 8; $i++) {
        $n = rand(0, $alphaLength);
        $pass[] = $alphabet[$n];
    }
    return implode($pass);
}

function genererDataSet($option){
    $userinfo = fopen("conf/userinfo".$option.".html", "w");
    $entreprisedao = new EntrepriseDAO;
    $roledao = new RoleDAO;
    $specialisationdao = new SpecialisationDAO;
    $utilisateurdao = new UtilisateurDAO;
    $googleAuthenticator = new PHPGangsta_GoogleAuthenticator();

    $lesentreprises = $entreprisedao->read(["", ""]);
    $lesroles = $roledao->read(["", ""]); 
    array_pop($lesroles);
    $lesspecialisations = $specialisationdao->read(["", ""]);

    for($i=0; $i < 100; $i++){
        $first_names = array(
            'Allison',
            'Arthur',
            'Ana',
            'Alex',
            'Arlene',
            'Alberto',
            'Barry',
            'Bertha',
            'Bill',
            'Bonnie',
            'Bret',
            'Beryl',
            'Chantal',
            'Cristobal',
            'Claudette',
            'Charley',
            'Cindy',
            'Chris',
            'Dean',
            'Dolly',
            'Danny',
            'Danielle',
            'Dennis',
            'Debby',
            'Erin',
            'Edouard',
            'Erika',
            'Earl',
            'Emily',
            'Ernesto',
            'Felix',
            'Fay',
            'Fabian',
            'Frances',
            'Franklin',
            'Florence',
            'Gabielle',
            'Gustav',
            'Grace',
            'Gaston',
            'Gert',
            'Gordon',
            'Humberto',
            'Hanna',
            'Henri',
            'Hermine',
            'Harvey',
            'Helene',
            'Iris',
            'Isidore',
            'Isabel',
            'Ivan',
            'Irene',
            'Isaac',
            'Jerry',
            'Josephine',
            'Juan',
            'Jeanne',
            'Jose',
            'Joyce',
            'Karen',
            'Kyle',
            'Kate',
            'Karl',
            'Katrina',
            'Kirk',
            'Lorenzo',
            'Lili',
            'Larry',
            'Lisa',
            'Lee',
            'Leslie',
            'Michelle',
            'Marco',
            'Mindy',
            'Maria',
            'Michael',
            'Noel',
            'Nana',
            'Nicholas',
            'Nicole',
            'Nate',
            'Nadine',
            'Olga',
            'Omar',
            'Odette',
            'Otto',
            'Ophelia',
            'Oscar',
            'Pablo',
            'Paloma',
            'Peter',
            'Paula',
            'Philippe',
            'Patty',
            'Rebekah',
            'Rene',
            'Rose',
            'Richard',
            'Rita',
            'Rafael',
            'Sebastien',
            'Sally',
            'Sam',
            'Shary',
            'Stan',
            'Sandy',
            'Tanya',
            'Teddy',
            'Teresa',
            'Tomas',
            'Tammy',
            'Tony',
            'Van',
            'Vicky',
            'Victor',
            'Virginie',
            'Vince',
            'Valerie',
            'Wendy',
            'Wilfred',
            'Wanda',
            'Walter',
            'Wilma',
            'William',
            'Kumiko',
            'Aki',
            'Miharu',
            'Chiaki',
            'Michiyo',
            'Itoe',
            'Nanaho',
            'Reina',
            'Emi',
            'Yumi',
            'Ayumi',
            'Kaori',
            'Sayuri',
            'Rie',
            'Miyuki',
            'Hitomi',
            'Naoko',
            'Miwa',
            'Etsuko',
            'Akane',
            'Kazuko',
            'Miyako',
            'Youko',
            'Sachiko',
            'Mieko',
            'Toshie',
            'Junko'
        );

        $last_names = array(
            'Abbott',
            'Acevedo',
            'Acosta',
            'Adams',
            'Adkins',
            'Aguilar',
            'Aguirre',
            'Albert',
            'Alexander',
            'Alford',
            'Allen',
            'Allison',
            'Alston',
            'Alvarado',
            'Alvarez',
            'Anderson',
            'Andrews',
            'Anthony',
            'Armstrong',
            'Arnold',
            'Ashley',
            'Atkins',
            'Atkinson',
            'Austin',
            'Avery',
            'Avila',
            'Ayala',
            'Ayers',
            'Bailey',
            'Baird',
            'Baker',
            'Baldwin',
            'Ball',
            'Ballard',
            'Banks',
            'Barber',
            'Barker',
            'Barlow',
            'Barnes',
            'Barnett',
            'Barr',
            'Barrera',
            'Barrett',
            'Barron',
            'Barry',
            'Bartlett',
            'Barton',
            'Bass',
            'Bates',
            'Battle',
            'Bauer',
            'Baxter',
            'Beach',
            'Bean',
            'Beard',
            'Beasley',
            'Beck',
            'Becker',
            'Bell',
            'Bender',
            'Benjamin',
            'Bennett',
            'Benson',
            'Bentley',
            'Benton',
            'Berg',
            'Berger',
            'Bernard',
            'Berry',
            'Best',
            'Bird',
            'Bishop',
            'Black',
            'Blackburn',
            'Blackwell',
            'Blair',
            'Blake',
            'Blanchard',
            'Blankenship',
            'Blevins',
            'Bolton',
            'Bond',
            'Bonner',
            'Booker',
            'Boone',
            'Booth',
            'Bowen',
            'Bowers',
            'Bowman',
            'Boyd',
            'Boyer',
            'Boyle',
            'Bradford',
            'Bradley',
            'Bradshaw',
            'Brady',
            'Branch',
            'Bray',
            'Brennan',
            'Brewer',
            'Bridges',
            'Briggs',
            'Bright',
            'Britt',
            'Brock',
            'Brooks',
            'Brown',
            'Browning',
            'Bruce',
            'Bryan',
            'Bryant',
            'Buchanan',
            'Buck',
            'Buckley',
            'Buckner',
            'Bullock',
            'Burch',
            'Burgess',
            'Burke',
            'Burks',
            'Burnett',
            'Burns',
            'Burris',
            'Burt',
            'Burton',
            'Bush',
            'Butler',
            'Byers',
            'Byrd',
            'Cabrera',
            'Cain',
            'Calderon',
            'Caldwell',
            'Calhoun',
            'Callahan',
            'Camacho',
            'Cameron',
            'Campbell',
            'Campos',
            'Cannon',
            'Cantrell',
            'Cantu',
            'Cardenas',
            'Carey',
            'Carlson',
            'Carney',
            'Carpenter',
            'Carr',
            'Carrillo',
            'Carroll',
            'Carson',
            'Carter',
            'Carver',
            'Case',
            'Casey',
            'Cash',
            'Castaneda',
            'Castillo',
            'Castro',
            'Cervantes',
            'Chambers',
            'Chan',
            'Chandler',
            'Chaney',
            'Chang',
            'Chapman',
            'Charles',
            'Chase',
            'Chavez',
            'Chen',
            'Cherry',
            'Christensen',
            'Christian',
            'Church',
            'Clark',
            'Clarke',
            'Clay',
            'Clayton',
            'Clements',
            'Clemons',
            'Cleveland',
            'Cline',
            'Cobb',
            'Cochran',
            'Coffey',
            'Cohen',
            'Cole',
            'Coleman',
            'Collier',
            'Collins',
            'Colon',
            'Combs',
            'Compton',
            'Conley',
            'Conner',
            'Conrad',
            'Contreras',
            'Conway',
            'Cook',
            'Cooke',
            'Cooley',
            'Cooper',
            'Copeland',
            'Cortez',
            'Cote',
            'Cotton',
            'Cox',
            'Craft',
            'Craig',
            'Crane',
            'Crawford',
            'Crosby',
            'Cross',
            'Cruz',
            'Cummings',
            'Cunningham',
            'Curry',
            'Curtis',
            'Dale',
            'Dalton',
            'Daniel',
            'Daniels',
            'Daugherty',
            'Davenport',
            'David',
            'Davidson',
            'Davis',
            'Dawson',
            'Day',
            'Dean',
            'Decker',
            'Dejesus',
            'Delacruz',
            'Delaney',
            'Deleon',
            'Delgado',
            'Dennis',
            'Diaz',
            'Dickerson',
            'Dickson',
            'Dillard',
            'Dillon',
            'Dixon',
            'Dodson',
            'Dominguez',
            'Donaldson',
            'Donovan',
            'Dorsey',
            'Dotson',
            'Douglas',
            'Downs',
            'Doyle',
            'Drake',
            'Dudley',
            'Duffy',
            'Duke',
            'Duncan',
            'Dunlap',
            'Dunn',
            'Duran',
            'Durham',
            'Dyer',
            'Eaton',
            'Edwards',
            'Elliott',
            'Ellis',
            'Ellison',
            'Emerson',
            'England',
            'English',
            'Erickson',
            'Espinoza',
            'Estes',
            'Estrada',
            'Evans',
            'Everett',
            'Ewing',
            'Farley',
            'Farmer',
            'Farrell',
            'Faulkner',
            'Ferguson',
            'Fernandez',
            'Ferrell',
            'Fields',
            'Figueroa',
            'Finch',
            'Finley',
            'Fischer',
            'Fisher',
            'Fitzgerald',
            'Fitzpatrick',
            'Fleming',
            'Fletcher',
            'Flores',
            'Flowers',
            'Floyd',
            'Flynn',
            'Foley',
            'Forbes',
            'Ford',
            'Foreman',
            'Foster',
            'Fowler',
            'Fox',
            'Francis',
            'Franco',
            'Frank',
            'Franklin',
            'Franks',
            'Frazier',
            'Frederick',
            'Freeman',
            'French',
            'Frost',
            'Fry',
            'Frye',
            'Fuentes',
            'Fuller',
            'Fulton',
            'Gaines',
            'Gallagher',
            'Gallegos',
            'Galloway',
            'Gamble',
            'Garcia',
            'Gardner',
            'Garner',
            'Garrett',
            'Garrison',
            'Garza',
            'Gates',
            'Gay',
            'Gentry',
            'George',
            'Gibbs',
            'Gibson',
            'Gilbert',
            'Giles',
            'Gill',
            'Gillespie',
            'Gilliam',
            'Gilmore',
            'Glass',
            'Glenn',
            'Glover',
            'Goff',
            'Golden',
            'Gomez',
            'Gonzales',
            'Gonzalez',
            'Good',
            'Goodman',
            'Goodwin',
            'Gordon',
            'Gould',
            'Graham',
            'Grant',
            'Graves',
            'Gray',
            'Green',
            'Greene',
            'Greer',
            'Gregory',
            'Griffin',
            'Griffith',
            'Grimes',
            'Gross',
            'Guerra',
            'Guerrero',
            'Guthrie',
            'Gutierrez',
            'Guy',
            'Guzman',
            'Hahn',
            'Hale',
            'Haley',
            'Hall',
            'Hamilton',
            'Hammond',
            'Hampton',
            'Hancock',
            'Haney',
            'Hansen',
            'Hanson',
            'Hardin',
            'Harding',
            'Hardy',
            'Harmon',
            'Harper',
            'Harrell',
            'Harrington',
            'Harris',
            'Harrison',
            'Hart',
            'Hartman',
            'Harvey',
            'Hatfield',
            'Hawkins',
            'Hayden',
            'Hayes',
            'Haynes',
            'Hays',
            'Head',
            'Heath',
            'Hebert',
            'Henderson',
            'Hendricks',
            'Hendrix',
            'Henry',
            'Hensley',
            'Henson',
            'Herman',
            'Hernandez',
            'Herrera',
            'Herring',
            'Hess',
            'Hester',
            'Hewitt',
            'Hickman',
            'Hicks',
            'Higgins',
            'Hill',
            'Hines',
            'Hinton',
            'Hobbs',
            'Hodge',
            'Hodges',
            'Hoffman',
            'Hogan',
            'Holcomb',
            'Holden',
            'Holder',
            'Holland',
            'Holloway',
            'Holman',
            'Holmes',
            'Holt',
            'Hood',
            'Hooper',
            'Hoover',
            'Hopkins',
            'Hopper',
            'Horn',
            'Horne',
            'Horton',
            'House',
            'Houston',
            'Howard',
            'Howe',
            'Howell',
            'Hubbard',
            'Huber',
            'Hudson',
            'Huff',
            'Huffman',
            'Hughes',
            'Hull',
            'Humphrey',
            'Hunt',
            'Hunter',
            'Hurley',
            'Hurst',
            'Hutchinson',
            'Hyde',
            'Ingram',
            'Irwin',
            'Jackson',
            'Jacobs',
            'Jacobson',
            'James',
            'Jarvis',
            'Jefferson',
            'Jenkins',
            'Jennings',
            'Jensen',
            'Jimenez',
            'Johns',
            'Johnson',
            'Johnston',
            'Jones',
            'Jordan',
            'Joseph',
            'Joyce',
            'Joyner',
            'Juarez',
            'Justice',
            'Kane',
            'Kaufman',
            'Keith',
            'Keller',
            'Kelley',
            'Kelly',
            'Kemp',
            'Kennedy',
            'Kent',
            'Kerr',
            'Key',
            'Kidd',
            'Kim',
            'King',
            'Kinney',
            'Kirby',
            'Kirk',
            'Kirkland',
            'Klein',
            'Kline',
            'Knapp',
            'Knight',
            'Knowles',
            'Knox',
            'Koch',
            'Kramer',
            'Lamb',
            'Lambert',
            'Lancaster',
            'Landry',
            'Lane',
            'Lang',
            'Langley',
            'Lara',
            'Larsen',
            'Larson',
            'Lawrence',
            'Lawson',
            'Le',
            'Leach',
            'Leblanc',
            'Lee',
            'Leon',
            'Leonard',
            'Lester',
            'Levine',
            'Levy',
            'Lewis',
            'Lindsay',
            'Lindsey',
            'Little',
            'Livingston',
            'Lloyd',
            'Logan',
            'Long',
            'Lopez',
            'Lott',
            'Love',
            'Lowe',
            'Lowery',
            'Lucas',
            'Luna',
            'Lynch',
            'Lynn',
            'Lyons',
            'Macdonald',
            'Macias',
            'Mack',
            'Madden',
            'Maddox',
            'Maldonado',
            'Malone',
            'Mann',
            'Manning',
            'Marks',
            'Marquez',
            'Marsh',
            'Marshall',
            'Martin',
            'Martinez',
            'Mason',
            'Massey',
            'Mathews',
            'Mathis',
            'Matthews',
            'Maxwell',
            'May',
            'Mayer',
            'Maynard',
            'Mayo',
            'Mays',
            'Mcbride',
            'Mccall',
            'Mccarthy',
            'Mccarty',
            'Mcclain',
            'Mcclure',
            'Mcconnell',
            'Mccormick',
            'Mccoy',
            'Mccray',
            'Mccullough',
            'Mcdaniel',
            'Mcdonald',
            'Mcdowell',
            'Mcfadden',
            'Mcfarland',
            'Mcgee',
            'Mcgowan',
            'Mcguire',
            'Mcintosh',
            'Mcintyre',
            'Mckay',
            'Mckee',
            'Mckenzie',
            'Mckinney',
            'Mcknight',
            'Mclaughlin',
            'Mclean',
            'Mcleod',
            'Mcmahon',
            'Mcmillan',
            'Mcneil',
            'Mcpherson',
            'Meadows',
            'Medina',
            'Mejia',
            'Melendez',
            'Melton',
            'Mendez',
            'Mendoza',
            'Mercado',
            'Mercer',
            'Merrill',
            'Merritt',
            'Meyer',
            'Meyers',
            'Michael',
            'Middleton',
            'Miles',
            'Miller',
            'Mills',
            'Miranda',
            'Mitchell',
            'Molina',
            'Monroe',
            'Montgomery',
            'Montoya',
            'Moody',
            'Moon',
            'Mooney',
            'Moore',
            'Morales',
            'Moran',
            'Moreno',
            'Morgan',
            'Morin',
            'Morris',
            'Morrison',
            'Morrow',
            'Morse',
            'Morton',
            'Moses',
            'Mosley',
            'Moss',
            'Mueller',
            'Mullen',
            'Mullins',
            'Munoz',
            'Murphy',
            'Murray',
            'Myers',
            'Nash',
            'Navarro',
            'Neal',
            'Nelson',
            'Newman',
            'Newton',
            'Nguyen',
            'Nichols',
            'Nicholson',
            'Nielsen',
            'Nieves',
            'Nixon',
            'Noble',
            'Noel',
            'Nolan',
            'Norman',
            'Norris',
            'Norton',
            'Nunez',
            'Obrien',
            'Ochoa',
            'Oconnor',
            'Odom',
            'Odonnell',
            'Oliver',
            'Olsen',
            'Olson',
            'Oneal',
            'Oneil',
            'Oneill',
            'Orr',
            'Ortega',
            'Ortiz',
            'Osborn',
            'Osborne',
            'Owen',
            'Owens',
            'Pace',
            'Pacheco',
            'Padilla',
            'Page',
            'Palmer',
            'Park',
            'Parker',
            'Parks',
            'Parrish',
            'Parsons',
            'Pate',
            'Patel',
            'Patrick',
            'Patterson',
            'Patton',
            'Paul',
            'Payne',
            'Pearson',
            'Peck',
            'Pena',
            'Pennington',
            'Perez',
            'Perkins',
            'Perry',
            'Peters',
            'Petersen',
            'Peterson',
            'Petty',
            'Phelps',
            'Phillips',
            'Pickett',
            'Pierce',
            'Pittman',
            'Pitts',
            'Pollard',
            'Poole',
            'Pope',
            'Porter',
            'Potter',
            'Potts',
            'Powell',
            'Powers',
            'Pratt',
            'Preston',
            'Price',
            'Prince',
            'Pruitt',
            'Puckett',
            'Pugh',
            'Quinn',
            'Ramirez',
            'Ramos',
            'Ramsey',
            'Randall',
            'Randolph',
            'Rasmussen',
            'Ratliff',
            'Ray',
            'Raymond',
            'Reed',
            'Reese',
            'Reeves',
            'Reid',
            'Reilly',
            'Reyes',
            'Reynolds',
            'Rhodes',
            'Rice',
            'Rich',
            'Richard',
            'Richards',
            'Richardson',
            'Richmond',
            'Riddle',
            'Riggs',
            'Riley',
            'Rios',
            'Rivas',
            'Rivera',
            'Rivers',
            'Roach',
            'Robbins',
            'Roberson',
            'Roberts',
            'Robertson',
            'Robinson',
            'Robles',
            'Rocha',
            'Rodgers',
            'Rodriguez',
            'Rodriquez',
            'Rogers',
            'Rojas',
            'Rollins',
            'Roman',
            'Romero',
            'Rosa',
            'Rosales',
            'Rosario',
            'Rose',
            'Ross',
            'Roth',
            'Rowe',
            'Rowland',
            'Roy',
            'Ruiz',
            'Rush',
            'Russell',
            'Russo',
            'Rutledge',
            'Ryan',
            'Salas',
            'Salazar',
            'Salinas',
            'Sampson',
            'Sanchez',
            'Sanders',
            'Sandoval',
            'Sanford',
            'Santana',
            'Santiago',
            'Santos',
            'Sargent',
            'Saunders',
            'Savage',
            'Sawyer',
            'Schmidt',
            'Schneider',
            'Schroeder',
            'Schultz',
            'Schwartz',
            'Scott',
            'Sears',
            'Sellers',
            'Serrano',
            'Sexton',
            'Shaffer',
            'Shannon',
            'Sharp',
            'Sharpe',
            'Shaw',
            'Shelton',
            'Shepard',
            'Shepherd',
            'Sheppard',
            'Sherman',
            'Shields',
            'Short',
            'Silva',
            'Simmons',
            'Simon',
            'Simpson',
            'Sims',
            'Singleton',
            'Skinner',
            'Slater',
            'Sloan',
            'Small',
            'Smith',
            'Snider',
            'Snow',
            'Snyder',
            'Solis',
            'Solomon',
            'Sosa',
            'Soto',
            'Sparks',
            'Spears',
            'Spence',
            'Spencer',
            'Stafford',
            'Stanley',
            'Stanton',
            'Stark',
            'Steele',
            'Stein',
            'Stephens',
            'Stephenson',
            'Stevens',
            'Stevenson',
            'Stewart',
            'Stokes',
            'Stone',
            'Stout',
            'Strickland',
            'Strong',
            'Stuart',
            'Suarez',
            'Sullivan',
            'Summers',
            'Sutton',
            'Swanson',
            'Sweeney',
            'Sweet',
            'Sykes',
            'Talley',
            'Tanner',
            'Tate',
            'Taylor',
            'Terrell',
            'Terry',
            'Thomas',
            'Thompson',
            'Thornton',
            'Tillman',
            'Todd',
            'Torres',
            'Townsend',
            'Tran',
            'Travis',
            'Trevino',
            'Trujillo',
            'Tucker',
            'Turner',
            'Tyler',
            'Tyson',
            'Underwood',
            'Valdez',
            'Valencia',
            'Valentine',
            'Valenzuela',
            'Vance',
            'Vang',
            'Vargas',
            'Vasquez',
            'Vaughan',
            'Vaughn',
            'Vazquez',
            'Vega',
            'Velasquez',
            'Velazquez',
            'Velez',
            'Villarreal',
            'Vincent',
            'Vinson',
            'Wade',
            'Wagner',
            'Walker',
            'Wall',
            'Wallace',
            'Waller',
            'Walls',
            'Walsh',
            'Walter',
            'Walters',
            'Walton',
            'Ward',
            'Ware',
            'Warner',
            'Warren',
            'Washington',
            'Waters',
            'Watkins',
            'Watson',
            'Watts',
            'Weaver',
            'Webb',
            'Weber',
            'Webster',
            'Weeks',
            'Weiss',
            'Welch',
            'Wells',
            'West',
            'Wheeler',
            'Whitaker',
            'White',
            'Whitehead',
            'Whitfield',
            'Whitley',
            'Whitney',
            'Wiggins',
            'Wilcox',
            'Wilder',
            'Wiley',
            'Wilkerson',
            'Wilkins',
            'Wilkinson',
            'William',
            'Williams',
            'Williamson',
            'Willis',
            'Wilson',
            'Winters',
            'Wise',
            'Witt',
            'Wolf',
            'Wolfe',
            'Wong',
            'Wood',
            'Woodard',
            'Woods',
            'Woodward',
            'Wooten',
            'Workman',
            'Wright',
            'Wyatt',
            'Wynn',
            'Yang',
            'Yates',
            'York',
            'Young',
            'Zamora',
            'Zimmerman'
        );

        $prenomIndx = array_rand($first_names);
        $nomIndx = array_rand($last_names);

        $entrInx = array_rand($lesentreprises);
        $roleInx = array_rand($lesroles);

        $nom = $last_names[$nomIndx];
        $prenom = $first_names[$prenomIndx];
        $entreprise = $lesentreprises[$entrInx];
        $role = $lesroles[$roleInx];
        $activation = rand(0,1);

        $numero = rand(1,2000);
        $rue = array("Charles de Gaulle", "Louis Pasteur", "Victor Hugo", "Jean Jaures", "Jean Moulin", "Leon Gambetta", "General Leclerc", "Jules Ferry", "Marechal Foch", "Georges Clemenceau", "de l'Eglise", "du Moulin", "du Chateau", "de la Mairie", "des Ecoles", "de la Gare", "Principale", "du Stade", "de la Fontaine", "Pasteur", "des Jardins");
        $adresse_complete = array(["Paris", "75000"], ["Marseille", "13000"],["Lyon","69000"], ["Toulouse","31000"], ["Nice","06000"], ["Nantes","44000"], ["Montpellier","34000"], ["Strasbourg","67000"], ["Bordeaux","33000"], ["Lille","59000"]);

        $rng = rand(0, 9);                                              
        $rng2 = rand(0, 20);
        $rng3 = rand(0,9);

        $adresse = (string)$numero." rue ".$rue[$rng2]." ".$adresse_complete[$rng3][0]." ".$adresse_complete[$rng3][1];

        $rue = " rue ".$rue[$rng2];
        $ville = $adresse_complete[$rng3][0];
        $code_postal = $adresse_complete[$rng3][1];
        $email = $nom.$prenom.$i."@telemedecine.com";
        $mot_de_passe = genererPassword();

        $telephone = genererTelephone();

        $cle_secrete = $googleAuthenticator->createSecret();
        $titre = 'Telemedecine ('.$email.')';
        $url_du_code_qr = $googleAuthenticator->getQRCodeGoogleUrl($titre, $cle_secrete);
        $specialisationInx = array_rand($lesspecialisations);
        $specialisation = $lesspecialisations[$specialisationInx];

        if($role->getId() == 2){
            echo $prenom." ".$nom." - ".$entreprise->getNom()." - ".$mot_de_passe." - ".$role->getNom()." - ".$specialisation->getNom()." - ".$adresse." - ".$email." - ".$telephone."/ ";
        }else{
            echo $prenom." ".$nom." - ".$entreprise->getNom()." - ".$role->getNom()." - ".$adresse." - ".$email." - ".$telephone." / ";
        }

        $authentification = new Authentification(null, null, $cle_secrete);
        $authentification->setMotdepasse($mot_de_passe);
        $entreprise = $entreprisedao->read(["siren", $entreprise->getSIREN()])[0];
        $role = $roledao->read(["id", $role->getId()])[0];
        
        if($role->getId() != 2){
            $specialisation = $specialisationdao->read(["id", "1"])[0];
        }else{
            $specialisation = $specialisationdao->read(["id", $specialisation->getId()])[0];
        }

        $utilisateur = new Utilisateur(
            null,
            $entreprise,
            $activation,
            $role,
            $specialisation,
            $authentification,
            $nom,
            $prenom,
            $email,
            $telephone,
            $numero,
            $rue,
            $ville,
            $code_postal,
            null
        );

        $utilisateurdao->create($utilisateur);

        fwrite($userinfo, "<h1>".$prenom." ".$nom."</h1><p>".$email."</p><p>".$mot_de_passe."</p><img src=\"".$url_du_code_qr."\"><br>");

    }
    fclose($userinfo);
}

genererDataSet("-mysql");
$contenu_settings = file_get_contents("conf/settings.ini");
$contenu_settings = preg_replace("/nom\s=\smysql/", "nom = pgsql", $contenu_settings);
$fh = fopen("conf/settings.ini", "w");
fwrite($fh, $contenu_settings);
genererDataSet("-pgsql");

$contenu_settings = file_get_contents("conf/settings.ini");
$contenu_settings = preg_replace("/nom\s=\spgsql/", "nom = mysql", $contenu_settings);
$fh = fopen("conf/settings.ini", "w");
fwrite($fh, $contenu_settings);
?>